\hypertarget{eccx08__ameth_8c}{}\section{C\+:/\+Source/\+Git\+Lab/\+Ca\+Sw/\+Open\+S\+S\+L/atmel-\/ecc/engine\+\_\+atecc/engine\+\_\+meth/eccx08\+\_\+ameth.c File Reference}
\label{eccx08__ameth_8c}\index{C\+:/\+Source/\+Git\+Lab/\+Ca\+Sw/\+Open\+S\+S\+L/atmel-\/ecc/engine\+\_\+atecc/engine\+\_\+meth/eccx08\+\_\+ameth.\+c@{C\+:/\+Source/\+Git\+Lab/\+Ca\+Sw/\+Open\+S\+S\+L/atmel-\/ecc/engine\+\_\+atecc/engine\+\_\+meth/eccx08\+\_\+ameth.\+c}}


Implementation of Open\+S\+S\+L E\+N\+G\+I\+N\+E callback functions for E\+C\+C See ec\+\_\+ameth.\+c for an example.  


{\ttfamily \#include $<$stdint.\+h$>$}\\*
{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include $<$assert.\+h$>$}\\*
{\ttfamily \#include $<$engine.\+h$>$}\\*
{\ttfamily \#include $<$openssl/x509.\+h$>$}\\*
{\ttfamily \#include $<$openssl/ec.\+h$>$}\\*
{\ttfamily \#include $<$openssl/bn.\+h$>$}\\*
{\ttfamily \#include $<$openssl/cms.\+h$>$}\\*
{\ttfamily \#include $<$openssl/asn1t.\+h$>$}\\*
{\ttfamily \#include $<$evp.\+h$>$}\\*
{\ttfamily \#include $<$ossl\+\_\+typ.\+h$>$}\\*
{\ttfamily \#include $<$err.\+h$>$}\\*
{\ttfamily \#include $<$crypto/asn1/asn1\+\_\+locl.\+h$>$}\\*
{\ttfamily \#include $<$crypto/ec/ec\+\_\+lcl.\+h$>$}\\*
{\ttfamily \#include $<$crypto/ecdsa/ecs\+\_\+locl.\+h$>$}\\*
{\ttfamily \#include \char`\"{}ecc\+\_\+meth.\+h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{eccx08__ameth_8c_abf6ce4edd143dc92024a11da42da0a9c}{eccx08\+\_\+item\+\_\+verify} (E\+V\+P\+\_\+\+M\+D\+\_\+\+C\+T\+X $\ast$ctx, const A\+S\+N1\+\_\+\+I\+T\+E\+M $\ast$it, void $\ast$asn, X509\+\_\+\+A\+L\+G\+O\+R $\ast$a, A\+S\+N1\+\_\+\+B\+I\+T\+\_\+\+S\+T\+R\+I\+N\+G $\ast$sig, E\+V\+P\+\_\+\+P\+K\+E\+Y $\ast$pkey)
\begin{DoxyCompactList}\small\item\em Verify an item signature (not used by ateccx08). \end{DoxyCompactList}\item 
int \hyperlink{eccx08__ameth_8c_af8d749a636f8cbcaca3d809b0b631006}{eccx08\+\_\+item\+\_\+sign} (E\+V\+P\+\_\+\+M\+D\+\_\+\+C\+T\+X $\ast$ctx, const A\+S\+N1\+\_\+\+I\+T\+E\+M $\ast$it, void $\ast$asn, X509\+\_\+\+A\+L\+G\+O\+R $\ast$algor1, X509\+\_\+\+A\+L\+G\+O\+R $\ast$algor2, A\+S\+N1\+\_\+\+B\+I\+T\+\_\+\+S\+T\+R\+I\+N\+G $\ast$signature)
\begin{DoxyCompactList}\small\item\em Generates a digest then sends the digest to the A\+T\+E\+C\+C\+X08 chip to generate an E\+C\+D\+S\+A signature using private key from T\+L\+S\+\_\+\+S\+L\+O\+T\+\_\+\+A\+U\+T\+H\+\_\+\+P\+R\+I\+V slot. The private key is always stays in the chip\+: Open\+S\+S\+L (nor any other software) has no way to read it. \end{DoxyCompactList}\item 
int \hyperlink{eccx08__ameth_8c_a9f0260faf614328f40a69242eec14b7b}{eccx08\+\_\+pkey\+\_\+asn1\+\_\+meth\+\_\+f} (E\+N\+G\+I\+N\+E $\ast$e, E\+V\+P\+\_\+\+P\+K\+E\+Y\+\_\+\+A\+S\+N1\+\_\+\+M\+E\+T\+H\+O\+D $\ast$$\ast$pkey\+\_\+asn1\+\_\+meth, const int $\ast$$\ast$nids, int nid)
\begin{DoxyCompactList}\small\item\em Initialize the E\+V\+P\+\_\+\+P\+K\+E\+Y\+\_\+\+A\+S\+N1\+\_\+\+M\+E\+T\+H\+O\+D method callback for ateccx08 engine. Just returns a pointer to E\+V\+P\+\_\+\+P\+K\+E\+Y\+\_\+\+M\+E\+T\+H\+O\+D eccx08\+\_\+pkey\+\_\+meth. \end{DoxyCompactList}\item 
int \hyperlink{eccx08__ameth_8c_a6ea72a82f48a7750297d61a2af7bcc63}{eccx08\+\_\+pkey\+\_\+asn1\+\_\+meth\+\_\+init} (void)
\begin{DoxyCompactList}\small\item\em Initialize the E\+V\+P\+\_\+\+P\+K\+E\+Y\+\_\+\+A\+S\+N1\+\_\+\+M\+E\+T\+H\+O\+D method for ateccx08 engine. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hypertarget{eccx08__ameth_8c_af4d1077c81308b0e41808bf251388a4f}{}E\+V\+P\+\_\+\+P\+K\+E\+Y\+\_\+\+A\+S\+N1\+\_\+\+M\+E\+T\+H\+O\+D \hyperlink{eccx08__ameth_8c_af4d1077c81308b0e41808bf251388a4f}{eccx08\+\_\+pkey\+\_\+asn1\+\_\+meth}\label{eccx08__ameth_8c_af4d1077c81308b0e41808bf251388a4f}

\begin{DoxyCompactList}\small\item\em eccx08\+\_\+pkey\+\_\+asn1\+\_\+meth is an Open\+S\+S\+L E\+V\+P\+\_\+\+P\+K\+E\+Y\+\_\+\+A\+S\+N1\+\_\+\+M\+E\+T\+H\+O\+D structure specific to the ateccx08 engine. See the crypto/asn1/asn1\+\_\+locl.\+h file for details on the struct evp\+\_\+pkey\+\_\+asn1\+\_\+method\+\_\+st \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Implementation of Open\+S\+S\+L E\+N\+G\+I\+N\+E callback functions for E\+C\+C See ec\+\_\+ameth.\+c for an example. 

Copyright (c) 2015 Atmel Corporation. All rights reserved.

\subsection{Function Documentation}
\hypertarget{eccx08__ameth_8c_af8d749a636f8cbcaca3d809b0b631006}{}\index{eccx08\+\_\+ameth.\+c@{eccx08\+\_\+ameth.\+c}!eccx08\+\_\+item\+\_\+sign@{eccx08\+\_\+item\+\_\+sign}}
\index{eccx08\+\_\+item\+\_\+sign@{eccx08\+\_\+item\+\_\+sign}!eccx08\+\_\+ameth.\+c@{eccx08\+\_\+ameth.\+c}}
\subsubsection[{eccx08\+\_\+item\+\_\+sign(\+E\+V\+P\+\_\+\+M\+D\+\_\+\+C\+T\+X $\ast$ctx, const A\+S\+N1\+\_\+\+I\+T\+E\+M $\ast$it, void $\ast$asn, X509\+\_\+\+A\+L\+G\+O\+R $\ast$algor1, X509\+\_\+\+A\+L\+G\+O\+R $\ast$algor2, A\+S\+N1\+\_\+\+B\+I\+T\+\_\+\+S\+T\+R\+I\+N\+G $\ast$signature)}]{\setlength{\rightskip}{0pt plus 5cm}int eccx08\+\_\+item\+\_\+sign (
\begin{DoxyParamCaption}
\item[{E\+V\+P\+\_\+\+M\+D\+\_\+\+C\+T\+X $\ast$}]{ctx, }
\item[{const A\+S\+N1\+\_\+\+I\+T\+E\+M $\ast$}]{it, }
\item[{void $\ast$}]{asn, }
\item[{X509\+\_\+\+A\+L\+G\+O\+R $\ast$}]{algor1, }
\item[{X509\+\_\+\+A\+L\+G\+O\+R $\ast$}]{algor2, }
\item[{A\+S\+N1\+\_\+\+B\+I\+T\+\_\+\+S\+T\+R\+I\+N\+G $\ast$}]{signature}
\end{DoxyParamCaption}
)}\label{eccx08__ameth_8c_af8d749a636f8cbcaca3d809b0b631006}


Generates a digest then sends the digest to the A\+T\+E\+C\+C\+X08 chip to generate an E\+C\+D\+S\+A signature using private key from T\+L\+S\+\_\+\+S\+L\+O\+T\+\_\+\+A\+U\+T\+H\+\_\+\+P\+R\+I\+V slot. The private key is always stays in the chip\+: Open\+S\+S\+L (nor any other software) has no way to read it. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ctx} & -\/ a pointer to the E\+V\+P\+\_\+\+M\+D\+\_\+\+C\+T\+X structure \\
\hline
\mbox{\tt in}  & {\em it} & -\/ a pointer to the A\+S\+N1\+\_\+\+I\+T\+E\+M structure \\
\hline
\mbox{\tt in}  & {\em asn} & -\/ a void pointer to the parameter \\
\hline
\mbox{\tt in}  & {\em algor1} & -\/ a pointer to the X509\+\_\+\+A\+L\+G\+O\+R structure \\
\hline
\mbox{\tt in}  & {\em algor2} & -\/ a pointer to the X509\+\_\+\+A\+L\+G\+O\+R structure \\
\hline
\mbox{\tt out}  & {\em signature} & -\/ a pointer to the A\+S\+N1\+\_\+\+B\+I\+T\+\_\+\+S\+T\+R\+I\+N\+G structure to return the signature in the A\+S\+N.\+1 format \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 for success 
\end{DoxyReturn}
\hypertarget{eccx08__ameth_8c_abf6ce4edd143dc92024a11da42da0a9c}{}\index{eccx08\+\_\+ameth.\+c@{eccx08\+\_\+ameth.\+c}!eccx08\+\_\+item\+\_\+verify@{eccx08\+\_\+item\+\_\+verify}}
\index{eccx08\+\_\+item\+\_\+verify@{eccx08\+\_\+item\+\_\+verify}!eccx08\+\_\+ameth.\+c@{eccx08\+\_\+ameth.\+c}}
\subsubsection[{eccx08\+\_\+item\+\_\+verify(\+E\+V\+P\+\_\+\+M\+D\+\_\+\+C\+T\+X $\ast$ctx, const A\+S\+N1\+\_\+\+I\+T\+E\+M $\ast$it, void $\ast$asn, X509\+\_\+\+A\+L\+G\+O\+R $\ast$a, A\+S\+N1\+\_\+\+B\+I\+T\+\_\+\+S\+T\+R\+I\+N\+G $\ast$sig, E\+V\+P\+\_\+\+P\+K\+E\+Y $\ast$pkey)}]{\setlength{\rightskip}{0pt plus 5cm}int eccx08\+\_\+item\+\_\+verify (
\begin{DoxyParamCaption}
\item[{E\+V\+P\+\_\+\+M\+D\+\_\+\+C\+T\+X $\ast$}]{ctx, }
\item[{const A\+S\+N1\+\_\+\+I\+T\+E\+M $\ast$}]{it, }
\item[{void $\ast$}]{asn, }
\item[{X509\+\_\+\+A\+L\+G\+O\+R $\ast$}]{a, }
\item[{A\+S\+N1\+\_\+\+B\+I\+T\+\_\+\+S\+T\+R\+I\+N\+G $\ast$}]{sig, }
\item[{E\+V\+P\+\_\+\+P\+K\+E\+Y $\ast$}]{pkey}
\end{DoxyParamCaption}
)}\label{eccx08__ameth_8c_abf6ce4edd143dc92024a11da42da0a9c}


Verify an item signature (not used by ateccx08). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ctx} & -\/ a pointer to the E\+V\+P\+\_\+\+M\+D\+\_\+\+C\+T\+X structure \\
\hline
\mbox{\tt in}  & {\em it} & -\/ a pointer to the A\+S\+N1\+\_\+\+I\+T\+E\+M structure \\
\hline
\mbox{\tt in}  & {\em asn} & -\/ a void pointer to the parameter \\
\hline
\mbox{\tt in}  & {\em a} & -\/ a pointer to the X509\+\_\+\+A\+L\+G\+O\+R structure \\
\hline
\mbox{\tt in}  & {\em sig} & -\/ a pointer to the A\+S\+N1\+\_\+\+B\+I\+T\+\_\+\+S\+T\+R\+I\+N\+G structure \\
\hline
\mbox{\tt in}  & {\em pkey} & -\/ a pointer to the E\+V\+P\+\_\+\+P\+K\+E\+Y structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 for success 
\end{DoxyReturn}
\hypertarget{eccx08__ameth_8c_a9f0260faf614328f40a69242eec14b7b}{}\index{eccx08\+\_\+ameth.\+c@{eccx08\+\_\+ameth.\+c}!eccx08\+\_\+pkey\+\_\+asn1\+\_\+meth\+\_\+f@{eccx08\+\_\+pkey\+\_\+asn1\+\_\+meth\+\_\+f}}
\index{eccx08\+\_\+pkey\+\_\+asn1\+\_\+meth\+\_\+f@{eccx08\+\_\+pkey\+\_\+asn1\+\_\+meth\+\_\+f}!eccx08\+\_\+ameth.\+c@{eccx08\+\_\+ameth.\+c}}
\subsubsection[{eccx08\+\_\+pkey\+\_\+asn1\+\_\+meth\+\_\+f(\+E\+N\+G\+I\+N\+E $\ast$e, E\+V\+P\+\_\+\+P\+K\+E\+Y\+\_\+\+A\+S\+N1\+\_\+\+M\+E\+T\+H\+O\+D $\ast$$\ast$pkey\+\_\+asn1\+\_\+meth, const int $\ast$$\ast$nids, int nid)}]{\setlength{\rightskip}{0pt plus 5cm}int eccx08\+\_\+pkey\+\_\+asn1\+\_\+meth\+\_\+f (
\begin{DoxyParamCaption}
\item[{E\+N\+G\+I\+N\+E $\ast$}]{e, }
\item[{E\+V\+P\+\_\+\+P\+K\+E\+Y\+\_\+\+A\+S\+N1\+\_\+\+M\+E\+T\+H\+O\+D $\ast$$\ast$}]{pkey\+\_\+asn1\+\_\+meth, }
\item[{const int $\ast$$\ast$}]{nids, }
\item[{int}]{nid}
\end{DoxyParamCaption}
)}\label{eccx08__ameth_8c_a9f0260faf614328f40a69242eec14b7b}


Initialize the E\+V\+P\+\_\+\+P\+K\+E\+Y\+\_\+\+A\+S\+N1\+\_\+\+M\+E\+T\+H\+O\+D method callback for ateccx08 engine. Just returns a pointer to E\+V\+P\+\_\+\+P\+K\+E\+Y\+\_\+\+M\+E\+T\+H\+O\+D eccx08\+\_\+pkey\+\_\+meth. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em e} & -\/ a pointer to the engine (ateccx08 in our case). \\
\hline
\mbox{\tt out}  & {\em pkey\+\_\+asn1\+\_\+meth} & -\/ a double pointer to E\+V\+P\+\_\+\+P\+K\+E\+Y\+\_\+\+A\+S\+N1\+\_\+\+M\+E\+T\+H\+O\+D to return the E\+V\+P\+\_\+\+P\+K\+E\+Y\+\_\+\+A\+S\+N1\+\_\+\+M\+E\+T\+H\+O\+D eccx08\+\_\+pkey\+\_\+asn1\+\_\+meth \\
\hline
\mbox{\tt out}  & {\em nids} & -\/ a double pointer to return an array of nid\textquotesingle{}s (we return 0) \\
\hline
\mbox{\tt in}  & {\em nid} & -\/ a number of expected nid\textquotesingle{}s (we ignore this parameter) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 for success 
\end{DoxyReturn}
\hypertarget{eccx08__ameth_8c_a6ea72a82f48a7750297d61a2af7bcc63}{}\index{eccx08\+\_\+ameth.\+c@{eccx08\+\_\+ameth.\+c}!eccx08\+\_\+pkey\+\_\+asn1\+\_\+meth\+\_\+init@{eccx08\+\_\+pkey\+\_\+asn1\+\_\+meth\+\_\+init}}
\index{eccx08\+\_\+pkey\+\_\+asn1\+\_\+meth\+\_\+init@{eccx08\+\_\+pkey\+\_\+asn1\+\_\+meth\+\_\+init}!eccx08\+\_\+ameth.\+c@{eccx08\+\_\+ameth.\+c}}
\subsubsection[{eccx08\+\_\+pkey\+\_\+asn1\+\_\+meth\+\_\+init(void)}]{\setlength{\rightskip}{0pt plus 5cm}int eccx08\+\_\+pkey\+\_\+asn1\+\_\+meth\+\_\+init (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\label{eccx08__ameth_8c_a6ea72a82f48a7750297d61a2af7bcc63}


Initialize the E\+V\+P\+\_\+\+P\+K\+E\+Y\+\_\+\+A\+S\+N1\+\_\+\+M\+E\+T\+H\+O\+D method for ateccx08 engine. 

\begin{DoxyReturn}{Returns}
1 for success 
\end{DoxyReturn}
