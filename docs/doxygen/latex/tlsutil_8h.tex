\hypertarget{tlsutil_8h}{}\section{C\+:/\+Source/\+Git\+Lab/\+Ca\+Sw/\+Open\+S\+S\+L/atmel-\/ecc/client-\/server/tlsutil.h File Reference}
\label{tlsutil_8h}\index{C\+:/\+Source/\+Git\+Lab/\+Ca\+Sw/\+Open\+S\+S\+L/atmel-\/ecc/client-\/server/tlsutil.\+h@{C\+:/\+Source/\+Git\+Lab/\+Ca\+Sw/\+Open\+S\+S\+L/atmel-\/ecc/client-\/server/tlsutil.\+h}}


Common functions for the T\+L\+S1.\+2 client/server exchange utility. It is an example of the programmatic use of the ateccx08 engine for T\+L\+S1.\+2 exchange. For details see \href{https://wiki.openssl.org/index.php/SSL/TLS_Client}{\tt https\+://wiki.\+openssl.\+org/index.\+php/\+S\+S\+L/\+T\+L\+S\+\_\+\+Client} and \href{https://wiki.openssl.org/index.php/Simple_TLS_Server}{\tt https\+://wiki.\+openssl.\+org/index.\+php/\+Simple\+\_\+\+T\+L\+S\+\_\+\+Server}.  


{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include $<$memory.\+h$>$}\\*
{\ttfamily \#include $<$unistd.\+h$>$}\\*
{\ttfamily \#include $<$errno.\+h$>$}\\*
{\ttfamily \#include $<$assert.\+h$>$}\\*
{\ttfamily \#include $<$sys/types.\+h$>$}\\*
{\ttfamily \#include $<$sys/socket.\+h$>$}\\*
{\ttfamily \#include $<$netinet/in.\+h$>$}\\*
{\ttfamily \#include $<$arpa/inet.\+h$>$}\\*
{\ttfamily \#include $<$netdb.\+h$>$}\\*
{\ttfamily \#include $<$openssl/crypto.\+h$>$}\\*
{\ttfamily \#include $<$openssl/x509.\+h$>$}\\*
{\ttfamily \#include $<$openssl/pem.\+h$>$}\\*
{\ttfamily \#include $<$openssl/ssl.\+h$>$}\\*
{\ttfamily \#include $<$openssl/err.\+h$>$}\\*
{\ttfamily \#include $<$openssl/engine.\+h$>$}\\*
{\ttfamily \#include $<$engine\+\_\+meth/ecc\+\_\+meth.\+h$>$}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\hypertarget{tlsutil_8h_a8a7893e51ad37e3d1ff919c20e68103d}{}\#define {\bfseries E\+X\+C\+H\+A\+N\+G\+E\+\_\+\+V\+E\+R\+S\+I\+O\+N}~\char`\"{}1.\+0.\+1\char`\"{}\label{tlsutil_8h_a8a7893e51ad37e3d1ff919c20e68103d}

\item 
\hypertarget{tlsutil_8h_a2202f63d963700d51e0020db9cb64df6}{}\#define {\bfseries P\+O\+R\+T\+\_\+\+N\+U\+M\+B\+E\+R}~(49917)\label{tlsutil_8h_a2202f63d963700d51e0020db9cb64df6}

\item 
\hypertarget{tlsutil_8h_a3d6d377a4b9232b677b770822c3a6ed3}{}\#define {\bfseries C\+H\+K\+\_\+\+N\+U\+L\+L}(x)~if ((x)==N\+U\+L\+L) \{ sleep(1); exit (1); \}\label{tlsutil_8h_a3d6d377a4b9232b677b770822c3a6ed3}

\item 
\hypertarget{tlsutil_8h_aa091ab859ba22622551371e9eb1300fe}{}\#define {\bfseries C\+H\+K\+\_\+\+E\+R\+R}(err,  s)~if ((err)==-\/1) \{ perror(s); sleep(1); exit(1); \}\label{tlsutil_8h_aa091ab859ba22622551371e9eb1300fe}

\item 
\hypertarget{tlsutil_8h_afd2737d414d1bf29a4b7e319851c4746}{}\#define {\bfseries C\+H\+K\+\_\+\+S\+S\+L}(err)~if ((err)==-\/1) \{ E\+R\+R\+\_\+print\+\_\+errors\+\_\+fp(stderr); sleep(2); exit(2); \}\label{tlsutil_8h_afd2737d414d1bf29a4b7e319851c4746}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{tlsutil_8h_a1aa2d27a453883e5e2bc75d727076e3e}{setup\+\_\+engine} (const char $\ast$engine\+\_\+id)
\begin{DoxyCompactList}\small\item\em setup Open\+S\+S\+L engine by engine I\+D \end{DoxyCompactList}\item 
\hypertarget{tlsutil_8h_aed9061f85d28851693abd4ac781e3d27}{}void \hyperlink{tlsutil_8h_aed9061f85d28851693abd4ac781e3d27}{init\+\_\+openssl} (void)\label{tlsutil_8h_aed9061f85d28851693abd4ac781e3d27}

\begin{DoxyCompactList}\small\item\em Calls Open\+S\+S\+L standard initialize methods. \end{DoxyCompactList}\item 
S\+S\+L\+\_\+\+C\+T\+X $\ast$ \hyperlink{tlsutil_8h_a66dff6d844a3ffd70f0bfabe52809211}{create\+\_\+context} (uint32\+\_\+t is\+\_\+server)
\begin{DoxyCompactList}\small\item\em Creates the S\+S\+L context for server or client. \end{DoxyCompactList}\item 
int \hyperlink{tlsutil_8h_a3686986951cb06131c3c7e67fe35a4d5}{config\+\_\+args\+\_\+ssl\+\_\+call} (S\+S\+L\+\_\+\+C\+T\+X $\ast$ctx, S\+S\+L\+\_\+\+C\+O\+N\+F\+\_\+\+C\+T\+X $\ast$cctx)
\begin{DoxyCompactList}\small\item\em A modification of the args\+\_\+ssl\+\_\+call() function from the openssl aps/s\+\_\+cb.\+c file. \end{DoxyCompactList}\item 
int \hyperlink{tlsutil_8h_a22bc66657938d8edb070d52b3421a35d}{configure\+\_\+context} (S\+S\+L\+\_\+\+C\+T\+X $\ast$ctx, const char $\ast$ca\+\_\+path, const char $\ast$chain\+\_\+file, const char $\ast$cert\+\_\+file)
\begin{DoxyCompactList}\small\item\em Configures the S\+S\+L context for server or client using provided certificates, chain files, and private keys (A\+T\+E\+C\+C\+X08 token are encoded into the Open\+S\+S\+L private key files) \end{DoxyCompactList}\item 
int \hyperlink{tlsutil_8h_adf9415420bf04e508e030b65bfa3b9a7}{load\+\_\+private\+\_\+key} (const char $\ast$engine\+\_\+id, S\+S\+L\+\_\+\+C\+T\+X $\ast$ctx, const char $\ast$key\+\_\+file)
\begin{DoxyCompactList}\small\item\em setup Open\+S\+S\+L engine by engine I\+D \end{DoxyCompactList}\item 
\hypertarget{tlsutil_8h_a83d44992530c78d43312acb7aa30fe4f}{}void \hyperlink{tlsutil_8h_a83d44992530c78d43312acb7aa30fe4f}{cleanup\+\_\+openssl} (void)\label{tlsutil_8h_a83d44992530c78d43312acb7aa30fe4f}

\begin{DoxyCompactList}\small\item\em Call Open\+S\+S\+L standard cleanup methods. \end{DoxyCompactList}\item 
int \hyperlink{tlsutil_8h_af001045c3edf01693c5826c12c8bf563}{connect\+\_\+client} (const char $\ast$engine\+\_\+id, const char $\ast$ca\+\_\+path, const char $\ast$chain\+\_\+file, const char $\ast$cert\+\_\+file, const char $\ast$key\+\_\+file, const char $\ast$cipher\+\_\+list)
\begin{DoxyCompactList}\small\item\em A complete procedure of connecting client using T\+L\+S-\/1.\+2 protocol over T\+C\+P/\+I\+P. \end{DoxyCompactList}\item 
int \hyperlink{tlsutil_8h_ac08479de4044117871d2b5ba30c8807f}{connect\+\_\+server} (const char $\ast$engine\+\_\+id, const char $\ast$ca\+\_\+path, const char $\ast$chain\+\_\+file, const char $\ast$cert\+\_\+file, const char $\ast$key\+\_\+file)
\begin{DoxyCompactList}\small\item\em A complete procedure of connecting server using T\+L\+S-\/1.\+2 protocol over T\+C\+P/\+I\+P. \end{DoxyCompactList}\item 
int \hyperlink{tlsutil_8h_afd0671747f0e7d21d7285aded74639f0}{save\+\_\+private\+\_\+key} (E\+V\+P\+\_\+\+P\+K\+E\+Y $\ast$pkey, const char $\ast$privkey\+\_\+fname)
\item 
int \hyperlink{tlsutil_8h_a7c5048adf433e91e7168fcd6f2f8afb8}{save\+\_\+x509\+\_\+certificate} (X509 $\ast$x509, const char $\ast$cert\+\_\+fname)
\item 
int \hyperlink{tlsutil_8h_a138afb41094f19e261ca1519585f6a30}{run\+\_\+engine\+\_\+cmds} (const char $\ast$engine\+\_\+id, int cmd, char $\ast$buffer, int len)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Common functions for the T\+L\+S1.\+2 client/server exchange utility. It is an example of the programmatic use of the ateccx08 engine for T\+L\+S1.\+2 exchange. For details see \href{https://wiki.openssl.org/index.php/SSL/TLS_Client}{\tt https\+://wiki.\+openssl.\+org/index.\+php/\+S\+S\+L/\+T\+L\+S\+\_\+\+Client} and \href{https://wiki.openssl.org/index.php/Simple_TLS_Server}{\tt https\+://wiki.\+openssl.\+org/index.\+php/\+Simple\+\_\+\+T\+L\+S\+\_\+\+Server}. 

Copyright (c) 2015 Atmel Corporation. All rights reserved.

\subsection{Function Documentation}
\hypertarget{tlsutil_8h_a3686986951cb06131c3c7e67fe35a4d5}{}\index{tlsutil.\+h@{tlsutil.\+h}!config\+\_\+args\+\_\+ssl\+\_\+call@{config\+\_\+args\+\_\+ssl\+\_\+call}}
\index{config\+\_\+args\+\_\+ssl\+\_\+call@{config\+\_\+args\+\_\+ssl\+\_\+call}!tlsutil.\+h@{tlsutil.\+h}}
\subsubsection[{config\+\_\+args\+\_\+ssl\+\_\+call(\+S\+S\+L\+\_\+\+C\+T\+X $\ast$ctx, S\+S\+L\+\_\+\+C\+O\+N\+F\+\_\+\+C\+T\+X $\ast$cctx)}]{\setlength{\rightskip}{0pt plus 5cm}int config\+\_\+args\+\_\+ssl\+\_\+call (
\begin{DoxyParamCaption}
\item[{S\+S\+L\+\_\+\+C\+T\+X $\ast$}]{ctx, }
\item[{S\+S\+L\+\_\+\+C\+O\+N\+F\+\_\+\+C\+T\+X $\ast$}]{cctx}
\end{DoxyParamCaption}
)}\label{tlsutil_8h_a3686986951cb06131c3c7e67fe35a4d5}


A modification of the args\+\_\+ssl\+\_\+call() function from the openssl aps/s\+\_\+cb.\+c file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ctx} & S\+S\+L context \\
\hline
\mbox{\tt in,out}  & {\em cctx} & S\+S\+L\+\_\+\+C\+O\+N\+F\+\_\+\+C\+T\+X \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 for success 
\end{DoxyReturn}
\hypertarget{tlsutil_8h_a22bc66657938d8edb070d52b3421a35d}{}\index{tlsutil.\+h@{tlsutil.\+h}!configure\+\_\+context@{configure\+\_\+context}}
\index{configure\+\_\+context@{configure\+\_\+context}!tlsutil.\+h@{tlsutil.\+h}}
\subsubsection[{configure\+\_\+context(\+S\+S\+L\+\_\+\+C\+T\+X $\ast$ctx, const char $\ast$ca\+\_\+path, const char $\ast$chain\+\_\+file, const char $\ast$cert\+\_\+file)}]{\setlength{\rightskip}{0pt plus 5cm}int configure\+\_\+context (
\begin{DoxyParamCaption}
\item[{S\+S\+L\+\_\+\+C\+T\+X $\ast$}]{ctx, }
\item[{const char $\ast$}]{ca\+\_\+path, }
\item[{const char $\ast$}]{chain\+\_\+file, }
\item[{const char $\ast$}]{cert\+\_\+file}
\end{DoxyParamCaption}
)}\label{tlsutil_8h_a22bc66657938d8edb070d52b3421a35d}


Configures the S\+S\+L context for server or client using provided certificates, chain files, and private keys (A\+T\+E\+C\+C\+X08 token are encoded into the Open\+S\+S\+L private key files) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ctx} & S\+S\+L context \\
\hline
\mbox{\tt in}  & {\em ca\+\_\+path} & Path to C\+A (Certificate Authority) \\
\hline
\mbox{\tt in}  & {\em chain\+\_\+file} & Chain File Name (Certificate Bundle) \\
\hline
\mbox{\tt in}  & {\em cert\+\_\+file} & Certificate File Name \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 for success 
\end{DoxyReturn}
\hypertarget{tlsutil_8h_af001045c3edf01693c5826c12c8bf563}{}\index{tlsutil.\+h@{tlsutil.\+h}!connect\+\_\+client@{connect\+\_\+client}}
\index{connect\+\_\+client@{connect\+\_\+client}!tlsutil.\+h@{tlsutil.\+h}}
\subsubsection[{connect\+\_\+client(const char $\ast$engine\+\_\+id, const char $\ast$ca\+\_\+path, const char $\ast$chain\+\_\+file, const char $\ast$cert\+\_\+file, const char $\ast$key\+\_\+file, const char $\ast$cipher\+\_\+list)}]{\setlength{\rightskip}{0pt plus 5cm}int connect\+\_\+client (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{engine\+\_\+id, }
\item[{const char $\ast$}]{ca\+\_\+path, }
\item[{const char $\ast$}]{chain\+\_\+file, }
\item[{const char $\ast$}]{cert\+\_\+file, }
\item[{const char $\ast$}]{key\+\_\+file, }
\item[{const char $\ast$}]{cipher\+\_\+list}
\end{DoxyParamCaption}
)}\label{tlsutil_8h_af001045c3edf01693c5826c12c8bf563}


A complete procedure of connecting client using T\+L\+S-\/1.\+2 protocol over T\+C\+P/\+I\+P. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em engine\+\_\+id} & Engine I\+D (use Software libraries if N\+U\+L\+L) \\
\hline
\mbox{\tt in}  & {\em ca\+\_\+path} & Path to C\+A (Certificate Authority) \\
\hline
\mbox{\tt in}  & {\em chain\+\_\+file} & Chain File Name (Certificate Bundle) \\
\hline
\mbox{\tt in}  & {\em cert\+\_\+file} & Certificate File Name \\
\hline
\mbox{\tt in}  & {\em key\+\_\+file} & Private Key File Name \\
\hline
\mbox{\tt in}  & {\em cipher\+\_\+list} & Cipher list string (E\+C\+D\+H-\/\+E\+C\+D\+S\+A-\/\+A\+E\+S128-\/\+S\+H\+A256, E\+C\+D\+H-\/\+E\+C\+D\+S\+A-\/\+A\+E\+S128-\/\+G\+C\+M-\/\+S\+H\+A256, etc) -\/ Must be S\+H\+A-\/256 for E\+C\+C508 \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 for success 
\end{DoxyReturn}
\hypertarget{tlsutil_8h_ac08479de4044117871d2b5ba30c8807f}{}\index{tlsutil.\+h@{tlsutil.\+h}!connect\+\_\+server@{connect\+\_\+server}}
\index{connect\+\_\+server@{connect\+\_\+server}!tlsutil.\+h@{tlsutil.\+h}}
\subsubsection[{connect\+\_\+server(const char $\ast$engine\+\_\+id, const char $\ast$ca\+\_\+path, const char $\ast$chain\+\_\+file, const char $\ast$cert\+\_\+file, const char $\ast$key\+\_\+file)}]{\setlength{\rightskip}{0pt plus 5cm}int connect\+\_\+server (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{engine\+\_\+id, }
\item[{const char $\ast$}]{ca\+\_\+path, }
\item[{const char $\ast$}]{chain\+\_\+file, }
\item[{const char $\ast$}]{cert\+\_\+file, }
\item[{const char $\ast$}]{key\+\_\+file}
\end{DoxyParamCaption}
)}\label{tlsutil_8h_ac08479de4044117871d2b5ba30c8807f}


A complete procedure of connecting server using T\+L\+S-\/1.\+2 protocol over T\+C\+P/\+I\+P. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em engine\+\_\+id} & Engine I\+D (use Software libraries if N\+U\+L\+L) \\
\hline
\mbox{\tt in}  & {\em ca\+\_\+path} & Path to C\+A (Certificate Authority) \\
\hline
\mbox{\tt in}  & {\em chain\+\_\+file} & Chain File Name (Certificate Bundle) \\
\hline
\mbox{\tt in}  & {\em cert\+\_\+file} & Certificate File Name \\
\hline
\mbox{\tt in}  & {\em key\+\_\+file} & Private Key File Name \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 for success 
\end{DoxyReturn}
\hypertarget{tlsutil_8h_a66dff6d844a3ffd70f0bfabe52809211}{}\index{tlsutil.\+h@{tlsutil.\+h}!create\+\_\+context@{create\+\_\+context}}
\index{create\+\_\+context@{create\+\_\+context}!tlsutil.\+h@{tlsutil.\+h}}
\subsubsection[{create\+\_\+context(uint32\+\_\+t is\+\_\+server)}]{\setlength{\rightskip}{0pt plus 5cm}S\+S\+L\+\_\+\+C\+T\+X$\ast$ create\+\_\+context (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{is\+\_\+server}
\end{DoxyParamCaption}
)}\label{tlsutil_8h_a66dff6d844a3ffd70f0bfabe52809211}


Creates the S\+S\+L context for server or client. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em is\+\_\+server} & 1 -\/ for server, 0 -\/ for client \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a pointer to S\+S\+L\+\_\+\+C\+T\+X for success, N\+U\+L\+L for error 
\end{DoxyReturn}
\hypertarget{tlsutil_8h_adf9415420bf04e508e030b65bfa3b9a7}{}\index{tlsutil.\+h@{tlsutil.\+h}!load\+\_\+private\+\_\+key@{load\+\_\+private\+\_\+key}}
\index{load\+\_\+private\+\_\+key@{load\+\_\+private\+\_\+key}!tlsutil.\+h@{tlsutil.\+h}}
\subsubsection[{load\+\_\+private\+\_\+key(const char $\ast$engine\+\_\+id, S\+S\+L\+\_\+\+C\+T\+X $\ast$ctx, const char $\ast$key\+\_\+file)}]{\setlength{\rightskip}{0pt plus 5cm}int load\+\_\+private\+\_\+key (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{engine\+\_\+id, }
\item[{S\+S\+L\+\_\+\+C\+T\+X $\ast$}]{ctx, }
\item[{const char $\ast$}]{key\+\_\+file}
\end{DoxyParamCaption}
)}\label{tlsutil_8h_adf9415420bf04e508e030b65bfa3b9a7}


setup Open\+S\+S\+L engine by engine I\+D 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em engine\+\_\+id} & Engine I\+D \\
\hline
 & {\em ctx\mbox{[}in\mbox{]}} & S\+S\+L context \\
\hline
 & {\em key\+\_\+file\mbox{[}in\mbox{]}} & Private Key File Name \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 for success, 0 for error 
\end{DoxyReturn}
\hypertarget{tlsutil_8h_a138afb41094f19e261ca1519585f6a30}{}\index{tlsutil.\+h@{tlsutil.\+h}!run\+\_\+engine\+\_\+cmds@{run\+\_\+engine\+\_\+cmds}}
\index{run\+\_\+engine\+\_\+cmds@{run\+\_\+engine\+\_\+cmds}!tlsutil.\+h@{tlsutil.\+h}}
\subsubsection[{run\+\_\+engine\+\_\+cmds(const char $\ast$engine\+\_\+id, int cmd, char $\ast$buffer, int len)}]{\setlength{\rightskip}{0pt plus 5cm}int run\+\_\+engine\+\_\+cmds (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{engine\+\_\+id, }
\item[{int}]{cmd, }
\item[{char $\ast$}]{buffer, }
\item[{int}]{len}
\end{DoxyParamCaption}
)}\label{tlsutil_8h_a138afb41094f19e261ca1519585f6a30}
Calls different engine commands by C\+M\+D I\+D


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em engine\+\_\+id} & Engine I\+D (just return if N\+U\+L\+L) \\
\hline
\mbox{\tt in}  & {\em cmd} & a command to pass to the engine library (for the list of commands see \hyperlink{ecc__meth_8h}{ecc\+\_\+meth.\+h} file \\
\hline
\mbox{\tt in,out}  & {\em buffer} & an optional buffer to pass into the command \\
\hline
\mbox{\tt in,out}  & {\em len} & the buffer size \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 for success, 0 for error 
\end{DoxyReturn}
\hypertarget{tlsutil_8h_afd0671747f0e7d21d7285aded74639f0}{}\index{tlsutil.\+h@{tlsutil.\+h}!save\+\_\+private\+\_\+key@{save\+\_\+private\+\_\+key}}
\index{save\+\_\+private\+\_\+key@{save\+\_\+private\+\_\+key}!tlsutil.\+h@{tlsutil.\+h}}
\subsubsection[{save\+\_\+private\+\_\+key(\+E\+V\+P\+\_\+\+P\+K\+E\+Y $\ast$pkey, const char $\ast$privkey\+\_\+fname)}]{\setlength{\rightskip}{0pt plus 5cm}int save\+\_\+private\+\_\+key (
\begin{DoxyParamCaption}
\item[{E\+V\+P\+\_\+\+P\+K\+E\+Y $\ast$}]{pkey, }
\item[{const char $\ast$}]{privkey\+\_\+fname}
\end{DoxyParamCaption}
)}\label{tlsutil_8h_afd0671747f0e7d21d7285aded74639f0}
Saves unencrypted private key in the P\+E\+M format. There is no reason to use password/encryption for keys tht are already in the hardware. Here we expect a pointer to the key, not a real key


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em pkey} & pointer to public/private key structure (private key may be just a tocken, pointing to the hardware) \\
\hline
\mbox{\tt in}  & {\em privkey\+\_\+fname} & Private Key File Name \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 for success 
\end{DoxyReturn}
\hypertarget{tlsutil_8h_a7c5048adf433e91e7168fcd6f2f8afb8}{}\index{tlsutil.\+h@{tlsutil.\+h}!save\+\_\+x509\+\_\+certificate@{save\+\_\+x509\+\_\+certificate}}
\index{save\+\_\+x509\+\_\+certificate@{save\+\_\+x509\+\_\+certificate}!tlsutil.\+h@{tlsutil.\+h}}
\subsubsection[{save\+\_\+x509\+\_\+certificate(\+X509 $\ast$x509, const char $\ast$cert\+\_\+fname)}]{\setlength{\rightskip}{0pt plus 5cm}int save\+\_\+x509\+\_\+certificate (
\begin{DoxyParamCaption}
\item[{X509 $\ast$}]{x509, }
\item[{const char $\ast$}]{cert\+\_\+fname}
\end{DoxyParamCaption}
)}\label{tlsutil_8h_a7c5048adf433e91e7168fcd6f2f8afb8}
Saves a certificate in the P\+E\+M format


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x509} & pointer to X509 structure with certificate \\
\hline
\mbox{\tt in}  & {\em cert\+\_\+fname} & Certificate file name \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 for success 
\end{DoxyReturn}
\hypertarget{tlsutil_8h_a1aa2d27a453883e5e2bc75d727076e3e}{}\index{tlsutil.\+h@{tlsutil.\+h}!setup\+\_\+engine@{setup\+\_\+engine}}
\index{setup\+\_\+engine@{setup\+\_\+engine}!tlsutil.\+h@{tlsutil.\+h}}
\subsubsection[{setup\+\_\+engine(const char $\ast$engine\+\_\+id)}]{\setlength{\rightskip}{0pt plus 5cm}int setup\+\_\+engine (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{engine\+\_\+id}
\end{DoxyParamCaption}
)}\label{tlsutil_8h_a1aa2d27a453883e5e2bc75d727076e3e}


setup Open\+S\+S\+L engine by engine I\+D 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em engine\+\_\+id} & Engine I\+D (just return if N\+U\+L\+L) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 for success, 0 for error 
\end{DoxyReturn}
